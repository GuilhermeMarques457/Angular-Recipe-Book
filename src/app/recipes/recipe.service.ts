import { Injectable } from '@angular/core';
import { Recipe } from './recipe.model';
import { Ingredients } from '../shared/ingredients.model';
import { ShoppingListService } from '../shopping-list/shopping-list.service';
import { Subject } from 'rxjs';

@Injectable()
export class RecipeService {
  recipesChanged = new Subject<Recipe[]>();

  constructor(private shoppingService: ShoppingListService) {}

  // private recipes: Recipe[] = [
  //   new Recipe(
  //     1,
  //     'CheeseBread',
  //     'A delicous brazilian breakfast',
  //     'https://amopaocaseiro.com.br/wp-content/uploads/2022/08/yt-069_pao-de-queijo_receita-840x560.jpg',
  //     [new Ingredients('cheese', 2), new Ingredients('flour', 5)]
  //   ),
  //   new Recipe(
  //     2,
  //     'CheeseBurger',
  //     'A trash fast food',
  //     'data:image/jpeg;base64,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',
  //     [new Ingredients('Hamburger', 1), new Ingredients('Cheese', 3)]
  //   ),
  // ];

  private recipes: Recipe[] = [];

  setRecipes(recipes: Recipe[]) {
    this.recipes = recipes;
    this.recipesChanged.next(this.recipes.slice());
  }

  getRecipes() {
    return this.recipes.slice();
  }

  getRecipeByID(id: number) {
    return this.recipes.find((recipe) => recipe.id === id);
  }

  addIngredientsToShoppingList(ingredients: Ingredients[]) {
    this.shoppingService.addIngredients(ingredients);
  }

  addRecipe(recipe: Recipe) {
    this.recipes.push(recipe);
    this.recipesChanged.next(this.recipes.slice());
  }

  updateRecipe(id: number, newRecipe: Recipe) {
    this.recipes[id - 1] = newRecipe;
    console.log(this.recipes[id - 1]);
    this.recipesChanged.next(this.recipes.slice());
  }

  deleteRecipe(id: number) {
    this.recipes.splice(id - 1, 1);
    this.recipesChanged.next(this.recipes.slice());
  }
}
